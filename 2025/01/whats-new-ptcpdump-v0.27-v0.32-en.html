<!DOCTYPE html>
<html lang="en"  prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml" class="han-init">
<head>
    <title>ptcpdump v0.27 ~ v0.32 的主要变更内容 - mozillazg's Blog</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- share.css -->
    <link rel="stylesheet" href="/theme/cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css">


    <link href="https://mozillazg.com/favicon.ico" rel="icon">

<link rel="canonical" href="https://mozillazg.com/2025/01/whats-new-ptcpdump-v0.27-v0.32-en.html">

        <meta name="author" content="mozillazg" />
        <meta name="keywords" content="others,ptcpdump" />
    <meta name="description" content="ptcpdump v0.27 ~ v0.32 的主要变更内容 - Introduction This article introduces the main changes in ptcpdump from v0.27 (after v0.26) to the latest v0.32, in chronological order. Main Changes Add -q/--quiet option Added the -q/--quiet option to simplify the output: 13:50:35.524360 lo curl.345650 Out IP 127.0.0.1.58694 &gt; 127.0.0.1.8000: tcp 0, ParentProc [bash.345626] Add --context option Added the --context option to specify the context information included in the output. This option controls showing only specific context information. Use --context=process to restrict output to process information only: # --context=process 09:32:09.718892 vethee2a302f wget.3553008 In IP 10.244.0.2.33426 &gt; 139.178.84.217.80: Flags [S], seq 4113492822, win 64240, length 0 # -v --context=process 13:44:41.529003 eth0 In IP (tos 0x4, ttl 45, id 45428, offset 0, flags [DF], proto TCP (6), length 52) 139.178.84.217.443 &gt; 172.19.0.2.42606: Flags [.], cksum 0x5284, seq 3173118145, ack 1385712707, win 118, options [nop,nop,TS val 134560683 ecr 1627716996], length 0 Process (pid 553587, cmd /usr/bin/wget, args wget kernel.org) This option supports specifying multiple values either by separating them with commas or by specifying the option multiple times: # -v --context=process,parentproc # -v --context=process --context=parentproc 13:44:41.529003 eth0 In IP (tos 0x4, ttl 45, id 45428, offset 0, flags [DF], proto TCP (6), length 52) 139.178.84.217.443 &gt; 172.19.0.2.42606: Flags [.], cksum 0x5284, seq 3173118145, ack 1385712707, win 118, ..." />

    <style>
      .js-toc {
        margin-bottom: 20px;
      }
      .donate-modal {
        text-align: center;
      }
      #donate-modal-container .donate-image {
        max-height: 300px !important;
        min-height: inherit !important;
      }
    </style>

        <meta property="og:site_name" content="mozillazg's Blog" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="ptcpdump v0.27 ~ v0.32 的主要变更内容"/>
        <meta property="og:url" content="https://mozillazg.com/2025/01/whats-new-ptcpdump-v0.27-v0.32-en.html"/>
        <meta property="og:description" content="Introduction This article introduces the main changes in ptcpdump from v0.27 (after v0.26) to the latest v0.32, in chronological order. Main Changes Add -q/--quiet option Added the -q/--quiet option to simplify the output: 13:50:35.524360 lo curl.345650 Out IP 127.0.0.1.58694 &gt; 127.0.0.1.8000: tcp 0, ParentProc [bash.345626] Add --context option Added the --context option to specify the context information included in the output. This option controls showing only specific context information. Use --context=process to restrict output to process information only: # --context=process 09:32:09.718892 vethee2a302f wget.3553008 In IP 10.244.0.2.33426 &gt; 139.178.84.217.80: Flags [S], seq 4113492822, win 64240, length 0 # -v --context=process 13:44:41.529003 eth0 In IP (tos 0x4, ttl 45, id 45428, offset 0, flags [DF], proto TCP (6), length 52) 139.178.84.217.443 &gt; 172.19.0.2.42606: Flags [.], cksum 0x5284, seq 3173118145, ack 1385712707, win 118, options [nop,nop,TS val 134560683 ecr 1627716996], length 0 Process (pid 553587, cmd /usr/bin/wget, args wget kernel.org) This option supports specifying multiple values either by separating them with commas or by specifying the option multiple times: # -v --context=process,parentproc # -v --context=process --context=parentproc 13:44:41.529003 eth0 In IP (tos 0x4, ttl 45, id 45428, offset 0, flags [DF], proto TCP (6), length 52) 139.178.84.217.443 &gt; 172.19.0.2.42606: Flags [.], cksum 0x5284, seq 3173118145, ack 1385712707, win 118, options [nop,nop,TS val 134560683 ecr 1627716996], length 0 Process (pid 553587, cmd /usr/bin/wget, args wget kernel.org) ParentProc (pid 553296, cmd /bin/sh, args sh) # -v --context=process,parentproc,container # -v --context=process --context=parentproc --context=container 13:44:41.529003 eth0 In IP (tos 0x4, ttl 45, id 45428, offset 0, flags [DF], proto TCP (6), length 52) 139.178.84.217.443 &gt; 172.19.0.2.42606: Flags [.], cksum 0x5284, seq 3173118145, ack 1385712707, win 118, options [nop,nop,TS val 134560683 ecr 1627716996], length 0 Process (pid 553587, cmd /usr/bin/wget, args wget kernel.org) ParentProc (pid 553296, cmd /bin/sh, args sh) Container (name test, id d9028334568bf75a5a084963a8f98f78c56bba7f45f823b3780a135b71b91e95, image docker.io/library/alpine:3.18, labels {&#34;io.cri-containerd.kind&#34;:&#34;container&#34;,&#34;io.kubernetes.container.name&#34;:&#34;test&#34;,&#34;io.kubernetes.pod.name&#34;:&#34;test&#34;,&#34;io.kubernetes.pod.namespace&#34;:&#34;default&#34;,&#34;io.kubernetes.pod.uid&#34;:&#34;9e4bc54b-de48-4b1c-8b9e-54709f67ed0c&#34;}) Use fentry, btf raw tracepoint, and tcx ebpf features on newer kernels When running ptcpdump on newer kernels, the program will automatically use fentry instead of kprobe, btf raw tracepoint instead of raw tracepoint, and tcx instead of tc. Using these new ebpf features optimizes performance on newer kernels. Add --backend option Added the --backend option to specify the technology used for packet capturing. The default is tc/tcx. Support --backend=cgroup-skb It now supports using --backend=cgroup-skb to capture packets using cgroup-skb ebpf programs. Traffic captured this way will not contain link-layer information; the link-layer information in ptcpdump output will be fixed fake data. Support OpenWrt 24.10 x86-64 system Based on user feedback, program compatibility has been improved to support using ptcpdump on OpenWrt 24.10 x86-64 systems (provided the system kernel was compiled with ebpf and BTF parameters enabled). Support displaying thread information in output When capturing packets using --backend=cgroup-skb, thread information is now displayed in the output: $ sudo ptcpdump -i any --backend cgroup-skb -v port 80 10:18:26.846884 ens33 Out IP (tos 0x0, ttl 64, id 57734, offset 0, flags [DF], proto TCP (6), length 478) xxx.xxx.xxx.35102 &gt; xxx.xxx.xxx.80: Flags [P.], cksum 0x3381, seq xx:xx, ack xx, win 64240, length 438 Process (pid 113278, cmd /snap/firefox/5437/usr/lib/firefox/firefox, args /snap/firefox/5437/usr/lib/firefox/firefox) Thread (tid 113438, name Socket Thread) ParentProc (pid 49607, cmd /usr/bin/xfce4-panel, args xfce4-panel --display :0.0 --sm-client-id xxxx) Support displaying UID in output and capturing by UID It now supports displaying UID information in the output: 12:37:40.051539 ens33 Out IP (tos 0x0, ttl 64, id 48697, offset 0, flags [DF], proto TCP (6), length 60) 10.0.x.x.42906 &gt; 139.x.x.x.443: Flags [S], cksum 0xecc8, seq 940329637, win 64240, options [mss 1460,sackOK,TS val 3421262256 ecr 0,nop,wscale 7], length 0 Process (pid 99722, cmd /usr/bin/curl, args curl https://kernel.org) User (uid 1000) ParentProc (pid 18840, cmd /usr/bin/bash, args -bash) It now supports specifying a UID for packet capturing: $ sudo ptcpdump -i any --uid 100 -v port 80 If you have additional improvements or new feature suggestions for ptcpdump, feel free to leave a message in the comments or project issues."/>
        <meta property="article:published_time" content="2025-01-25" />
            <meta property="article:section" content="others" />
            <meta property="article:tag" content="others" />
            <meta property="article:tag" content="ptcpdump" />
            <meta property="article:author" content="mozillazg" />
            <meta property="og:image"
                  content="https://mozillazg.com/static/avatar.jpeg"/>


    <meta name="twitter:card" content="summary">
        <meta name="twitter:site" content="@mozillazg">
        <meta name="twitter:creator" content="@mozillazg">
    <meta name="twitter:domain" content="https://mozillazg.com">
            <meta property="twitter:image"
                  content="https://mozillazg.com/static/avatar.jpeg"/>

    <!-- Bootstrap -->
        <link rel="stylesheet" href="/theme/cdn.jsdelivr.net/npm/bootstrap@3.3.4/dist/css/bootstrap.min.css" type="text/css"/>
    <link href="/theme/cdn.jsdelivr.net/npm/font-awesome@4.3.0/css/font-awesome.min.css" rel="stylesheet">

    <link href="/theme/cdn.jsdelivr.net/npm/pygments-css@1.0.0/github.css" rel="stylesheet">
    <link rel="stylesheet" href="https://mozillazg.com/theme/css/style.css" type="text/css"/>
            <link href="/static/han.min.css" rel="stylesheet">
            <link href="/static/yue.css" rel="stylesheet">
            <link href="/static/custom.css" rel="stylesheet">

        <link href="https://mozillazg.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="mozillazg's Blog ATOM Feed"/>

        <link href="https://mozillazg.com/feeds/all.rss.xml" type="application/rss+xml" rel="alternate"
              title="mozillazg's Blog RSS Feed"/>


        <link href="https://mozillazg.com/feeds/others.atom.xml" type="application/atom+xml" rel="alternate"
              title="mozillazg's Blog others ATOM Feed"/>


    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BlogPosting",
        "publisher": {
            "@type": "Person",
            "name": "mozillazg",
            "logo": "https://mozillazg.com/static/avatar.jpeg"
        },
        "author": {
            "@type": "Person",
            "name": "mozillazg",
            "image": "https://mozillazg.com/static/avatar.jpeg",
            "url": "https://mozillazg.com",
            "sameAs": []
        },
        "headline": "ptcpdump v0.27 ~ v0.32 的主要变更内容",
        "url": "https://mozillazg.com/2025/01/whats-new-ptcpdump-v0.27-v0.32-en.html",
        "image": [
            "https://mozillazg.com/static/avatar.jpeg"
         ],
        "keywords": "others, ptcpdump",
        "description": "Introduction This article introduces the main changes in ptcpdump from v0.27 (after v0.26) to the latest v0.32, in chronological order. Main Changes Add -q/--quiet option Added the -q/--quiet option to simplify the output: 13:50:35.524360 lo curl.345650 Out IP 127.0.0.1.58694 &gt; 127.0.0.1.8000: tcp 0, ParentProc [bash.345626] Add --context option Added the --context option to specify the context information included in the output. This option controls showing only specific context information. Use --context=process to restrict output to process information only: # --context=process 09:32:09.718892 vethee2a302f wget.3553008 In IP 10.244.0.2.33426 &gt; 139.178.84.217.80: Flags [S], seq 4113492822, win 64240, length 0 # -v --context=process 13:44:41.529003 eth0 In IP (tos 0x4, ttl 45, id 45428, offset 0, flags [DF], proto TCP (6), length 52) 139.178.84.217.443 &gt; 172.19.0.2.42606: Flags [.], cksum 0x5284, seq 3173118145, ack 1385712707, win 118, options [nop,nop,TS val 134560683 ecr 1627716996], length 0 Process (pid 553587, cmd /usr/bin/wget, args wget kernel.org) This option supports specifying multiple values either by separating them with commas or by specifying the option multiple times: # -v --context=process,parentproc # -v --context=process --context=parentproc 13:44:41.529003 eth0 In IP (tos 0x4, ttl 45, id 45428, offset 0, flags [DF], proto TCP (6), length 52) 139.178.84.217.443 &gt; 172.19.0.2.42606: Flags [.], cksum 0x5284, seq 3173118145, ack 1385712707, win 118, options [nop,nop,TS val 134560683 ecr 1627716996], length 0 Process (pid 553587, cmd /usr/bin/wget, args wget kernel.org) ParentProc (pid 553296, cmd /bin/sh, args sh) # -v --context=process,parentproc,container # -v --context=process --context=parentproc --context=container 13:44:41.529003 eth0 In IP (tos 0x4, ttl 45, id 45428, offset 0, flags [DF], proto TCP (6), length 52) 139.178.84.217.443 &gt; 172.19.0.2.42606: Flags [.], cksum 0x5284, seq 3173118145, ack 1385712707, win 118, options [nop,nop,TS val 134560683 ecr 1627716996], length 0 Process (pid 553587, cmd /usr/bin/wget, args wget kernel.org) ParentProc (pid 553296, cmd /bin/sh, args sh) Container (name test, id d9028334568bf75a5a084963a8f98f78c56bba7f45f823b3780a135b71b91e95, image docker.io/library/alpine:3.18, labels {&#34;io.cri-containerd.kind&#34;:&#34;container&#34;,&#34;io.kubernetes.container.name&#34;:&#34;test&#34;,&#34;io.kubernetes.pod.name&#34;:&#34;test&#34;,&#34;io.kubernetes.pod.namespace&#34;:&#34;default&#34;,&#34;io.kubernetes.pod.uid&#34;:&#34;9e4bc54b-de48-4b1c-8b9e-54709f67ed0c&#34;}) Use fentry, btf raw tracepoint, and tcx ebpf features on newer kernels When running ptcpdump on newer kernels, the program will automatically use fentry instead of kprobe, btf raw tracepoint instead of raw tracepoint, and tcx instead of tc. Using these new ebpf features optimizes performance on newer kernels. Add --backend option Added the --backend option to specify the technology used for packet capturing. The default is tc/tcx. Support --backend=cgroup-skb It now supports using --backend=cgroup-skb to capture packets using cgroup-skb ebpf programs. Traffic captured this way will not contain link-layer information; the link-layer information in ptcpdump output will be fixed fake data. Support OpenWrt 24.10 x86-64 system Based on user feedback, program compatibility has been improved to support using ptcpdump on OpenWrt 24.10 x86-64 systems (provided the system kernel was compiled with ebpf and BTF parameters enabled). Support displaying thread information in output When capturing packets using --backend=cgroup-skb, thread information is now displayed in the output: $ sudo ptcpdump -i any --backend cgroup-skb -v port 80 10:18:26.846884 ens33 Out IP (tos 0x0, ttl 64, id 57734, offset 0, flags [DF], proto TCP (6), length 478) xxx.xxx.xxx.35102 &gt; xxx.xxx.xxx.80: Flags [P.], cksum 0x3381, seq xx:xx, ack xx, win 64240, length 438 Process (pid 113278, cmd /snap/firefox/5437/usr/lib/firefox/firefox, args /snap/firefox/5437/usr/lib/firefox/firefox) Thread (tid 113438, name Socket Thread) ParentProc (pid 49607, cmd /usr/bin/xfce4-panel, args xfce4-panel --display :0.0 --sm-client-id xxxx) Support displaying UID in output and capturing by UID It now supports displaying UID information in the output: 12:37:40.051539 ens33 Out IP (tos 0x0, ttl 64, id 48697, offset 0, flags [DF], proto TCP (6), length 60) 10.0.x.x.42906 &gt; 139.x.x.x.443: Flags [S], cksum 0xecc8, seq 940329637, win 64240, options [mss 1460,sackOK,TS val 3421262256 ecr 0,nop,wscale 7], length 0 Process (pid 99722, cmd /usr/bin/curl, args curl https://kernel.org) User (uid 1000) ParentProc (pid 18840, cmd /usr/bin/bash, args -bash) It now supports specifying a UID for packet capturing: $ sudo ptcpdump -i any --uid 100 -v port 80 If you have additional improvements or new feature suggestions for ptcpdump, feel free to leave a message in the comments or project issues.",
        "mainEntityOfPage": {
             "@type": "WebPage",
             "@id": "https://mozillazg.com/2025/01/whats-new-ptcpdump-v0.27-v0.32-en.html"
        },
        "datePublished": "2025-01-25"
    }
    </script>

</head>
<body>

<div class="navbar" role="navigation">
	<div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="https://mozillazg.com/" class="navbar-brand">
mozillazg's Blog            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                    <li><a href="https://mozillazg.com/feeds/all.atom.xml">Feed</a></li>
                    <li><a href="/2014/10/pages/about-me.html">About</a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li><a href="https://mozillazg.com/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->
<div class="container">
    <div class="row">
        <div class="col-lg-12">
    <section id="content" class="yue">
        <article>
            <header class="text-center">
                <h1>
                    <a href="https://mozillazg.com/2025/01/whats-new-ptcpdump-v0.27-v0.32-en.html"
                       rel="bookmark"
                       title="Permalink to ptcpdump v0.27 ~ v0.32 的主要变更内容">
                        ptcpdump v0.27 ~ v0.32 的主要变更内容
                    </a>
                </h1>
                <p class="published">
                    <time datetime="2025-01-25T00:00:00+00:00">
                    2025-01-25
                    </time>
                </p>
            </header>
            <div class="entry-content">
                <div class="well-sm article-info">
<footer class="post-info">
        <a href="https://mozillazg.com/category/others.html">others</a>


<span class="label label-default hide">Tags</span>
	<a href="https://mozillazg.com/tag/ptcpdump.html">ptcpdump</a>
    <span class="label label-default">Lang</span>
	<a href="https://mozillazg.com/2025/01/whats-new-ptcpdump-v0.27-v0.32.html">zh</a>

</footer><!-- /.post-info -->                </div>
                <div class="js-toc"></div>
                <div>
                <div class="section" id="introduction">
<h2 id="hidintroduction">Introduction<a class="headerlink" href="#hidintroduction" title="Permalink to this headline">¶</a></h2>
<p>This article introduces the main changes in <a class="reference external" href="https://github.com/mozillazg/ptcpdump">ptcpdump</a>
from v0.27 (after <a class="reference external" href="https://mozillazg.com/2024/11/whats-new-ptcpdump-v1.16-v1.26-en.html">v0.26</a>)
to the latest v0.32, in chronological order.</p>
</div>
<div class="section" id="main-changes">
<h2 id="hidmain-changes">Main Changes<a class="headerlink" href="#hidmain-changes" title="Permalink to this headline">¶</a></h2>
<div class="section" id="add-q-quiet-option">
<h3 id="hidadd-q-quiet-option">Add -q/--quiet option<a class="headerlink" href="#hidadd-q-quiet-option" title="Permalink to this headline">¶</a></h3>
<p>Added the <tt class="docutils literal"><span class="pre">-q/--quiet</span></tt> option to simplify the output:</p>
<pre class="literal-block">
13:50:35.524360 lo curl.345650 Out IP 127.0.0.1.58694 &gt; 127.0.0.1.8000: tcp 0, ParentProc [bash.345626]
</pre>
</div>
<div class="section" id="add-context-option">
<h3 id="hidadd-context-option">Add --context option<a class="headerlink" href="#hidadd-context-option" title="Permalink to this headline">¶</a></h3>
<p>Added the <tt class="docutils literal"><span class="pre">--context</span></tt> option to specify the context information included in the output. This option controls showing only specific context information.</p>
<ul>
<li><p class="first">Use <tt class="docutils literal"><span class="pre">--context=process</span></tt> to restrict output to process information only:</p>
<pre class="literal-block">
# --context=process
09:32:09.718892 vethee2a302f wget.3553008 In IP 10.244.0.2.33426 &gt; 139.178.84.217.80: Flags [S], seq 4113492822, win 64240, length 0

# -v --context=process
13:44:41.529003 eth0 In IP (tos 0x4, ttl 45, id 45428, offset 0, flags [DF], proto TCP (6), length 52)
    139.178.84.217.443 &gt; 172.19.0.2.42606: Flags [.], cksum 0x5284, seq 3173118145, ack 1385712707, win 118, options [nop,nop,TS val 134560683 ecr 1627716996], length 0
    Process (pid 553587, cmd /usr/bin/wget, args wget kernel.org)
</pre>
</li>
<li><p class="first">This option supports specifying multiple values either by separating them with commas or by specifying the option multiple times:</p>
<pre class="literal-block">
# -v --context=process,parentproc
# -v --context=process --context=parentproc

13:44:41.529003 eth0 In IP (tos 0x4, ttl 45, id 45428, offset 0, flags [DF], proto TCP (6), length 52)
    139.178.84.217.443 &gt; 172.19.0.2.42606: Flags [.], cksum 0x5284, seq 3173118145, ack 1385712707, win 118, options [nop,nop,TS val 134560683 ecr 1627716996], length 0
    Process (pid 553587, cmd /usr/bin/wget, args wget kernel.org)
    ParentProc (pid 553296, cmd /bin/sh, args sh)

# -v --context=process,parentproc,container
# -v --context=process --context=parentproc --context=container

13:44:41.529003 eth0 In IP (tos 0x4, ttl 45, id 45428, offset 0, flags [DF], proto TCP (6), length 52)
    139.178.84.217.443 &gt; 172.19.0.2.42606: Flags [.], cksum 0x5284, seq 3173118145, ack 1385712707, win 118, options [nop,nop,TS val 134560683 ecr 1627716996], length 0
    Process (pid 553587, cmd /usr/bin/wget, args wget kernel.org)
    ParentProc (pid 553296, cmd /bin/sh, args sh)
    Container (name test, id d9028334568bf75a5a084963a8f98f78c56bba7f45f823b3780a135b71b91e95, image docker.io/library/alpine:3.18, labels {&quot;io.cri-containerd.kind&quot;:&quot;container&quot;,&quot;io.kubernetes.container.name&quot;:&quot;test&quot;,&quot;io.kubernetes.pod.name&quot;:&quot;test&quot;,&quot;io.kubernetes.pod.namespace&quot;:&quot;default&quot;,&quot;io.kubernetes.pod.uid&quot;:&quot;9e4bc54b-de48-4b1c-8b9e-54709f67ed0c&quot;})
</pre>
</li>
</ul>
</div>
<div class="section" id="use-fentry-btf-raw-tracepoint-and-tcx-ebpf-features-on-newer-kernels">
<h3 id="hiduse-fentry-btf-raw-tracepoint-and-tcx-ebpf-features-on-newer-kernels">Use fentry, btf raw tracepoint, and tcx ebpf features on newer kernels<a class="headerlink" href="#hiduse-fentry-btf-raw-tracepoint-and-tcx-ebpf-features-on-newer-kernels" title="Permalink to this headline">¶</a></h3>
<p>When running ptcpdump on newer kernels, the program will automatically use fentry instead of kprobe,
btf raw tracepoint instead of raw tracepoint, and tcx instead of tc.
Using these new ebpf features optimizes performance on newer kernels.</p>
</div>
<div class="section" id="add-backend-option">
<h3 id="hidadd-backend-option">Add --backend option<a class="headerlink" href="#hidadd-backend-option" title="Permalink to this headline">¶</a></h3>
<p>Added the <tt class="docutils literal"><span class="pre">--backend</span></tt> option to specify the technology used for packet capturing. The default is tc/tcx.</p>
</div>
<div class="section" id="support-backend-cgroup-skb">
<h3 id="hidsupport-backend-cgroup-skb">Support --backend=cgroup-skb<a class="headerlink" href="#hidsupport-backend-cgroup-skb" title="Permalink to this headline">¶</a></h3>
<p>It now supports using <tt class="docutils literal"><span class="pre">--backend=cgroup-skb</span></tt> to capture packets using cgroup-skb ebpf programs.
Traffic captured this way will not contain link-layer information; the link-layer information in ptcpdump output will be fixed fake data.</p>
</div>
<div class="section" id="support-openwrt-24-10-x86-64-system">
<h3 id="hidsupport-openwrt-24-10-x86-64-system">Support OpenWrt 24.10 x86-64 system<a class="headerlink" href="#hidsupport-openwrt-24-10-x86-64-system" title="Permalink to this headline">¶</a></h3>
<p>Based on user feedback, program compatibility has been improved to support using ptcpdump on OpenWrt 24.10 x86-64 systems (provided the system kernel was compiled with ebpf and BTF parameters enabled).</p>
</div>
<div class="section" id="support-displaying-thread-information-in-output">
<h3 id="hidsupport-displaying-thread-information-in-output">Support displaying thread information in output<a class="headerlink" href="#hidsupport-displaying-thread-information-in-output" title="Permalink to this headline">¶</a></h3>
<p>When capturing packets using <tt class="docutils literal"><span class="pre">--backend=cgroup-skb</span></tt>, thread information is now displayed in the output:</p>
<pre class="literal-block">
$ sudo ptcpdump -i any --backend cgroup-skb -v port 80

10:18:26.846884 ens33 Out IP (tos 0x0, ttl 64, id 57734, offset 0, flags [DF], proto TCP (6), length 478)
    xxx.xxx.xxx.35102 &gt; xxx.xxx.xxx.80: Flags [P.], cksum 0x3381, seq xx:xx, ack xx, win 64240, length 438
    Process (pid 113278, cmd /snap/firefox/5437/usr/lib/firefox/firefox, args /snap/firefox/5437/usr/lib/firefox/firefox)
    Thread (tid 113438, name Socket Thread)
    ParentProc (pid 49607, cmd /usr/bin/xfce4-panel, args xfce4-panel --display :0.0 --sm-client-id xxxx)
</pre>
</div>
<div class="section" id="support-displaying-uid-in-output-and-capturing-by-uid">
<h3 id="hidsupport-displaying-uid-in-output-and-capturing-by-uid">Support displaying UID in output and capturing by UID<a class="headerlink" href="#hidsupport-displaying-uid-in-output-and-capturing-by-uid" title="Permalink to this headline">¶</a></h3>
<p>It now supports displaying UID information in the output:</p>
<pre class="literal-block">
12:37:40.051539 ens33 Out IP (tos 0x0, ttl 64, id 48697, offset 0, flags [DF], proto TCP (6), length 60)
    10.0.x.x.42906 &gt; 139.x.x.x.443: Flags [S], cksum 0xecc8, seq 940329637, win 64240, options [mss 1460,sackOK,TS val 3421262256 ecr 0,nop,wscale 7], length 0
    Process (pid 99722, cmd /usr/bin/curl, args curl https://kernel.org)
    User (uid 1000)
    ParentProc (pid 18840, cmd /usr/bin/bash, args -bash)
</pre>
<p>It now supports specifying a UID for packet capturing:</p>
<pre class="literal-block">
$ sudo ptcpdump -i any --uid 100 -v port 80
</pre>
<p>If you have additional improvements or new feature suggestions for ptcpdump,
feel free to leave a message in the comments or project issues.</p>
</div>
</div>

                </div>
            </div>
            <!-- /.entry-content -->
<section class="text-center">
  
<div id="donate"></div>

<div class="social-share"></div>
<div class="social-comment-note">
<p class="text-center">有任何建议和想法欢迎在下方评论区留言或者加我<a href="/static/wechat.png">微信</a>交流</p>
</div>

</section>
<section class="well" id="related-posts">
    <p>Related Posts:</p>
    <ul>
        <li><a href="https://mozillazg.com/2024/07/ebpf-ptcpdump-capturing-the-network-traffic-of-a-process-or-container-or-pod-en.html">ptcpdump: Capturing the Network Traffic of any Process, Container, or Pod</a></li>
        <li><a href="https://mozillazg.com/2025/11/whats-new-ptcpdump-v0.33-v0.37-en.html">Major Changes in ptcpdump versions 0.33 to 0.37</a></li>
        <li><a href="https://mozillazg.com/2024/11/whats-new-ptcpdump-v1.16-v1.26-en.html">Major Changes in ptcpdump versions 0.16 to 0.26</a></li>
        <li><a href="https://mozillazg.com/2025/11/whats-new-ptcpdump-v0.33-v0.37.html">ptcpdump v0.33 ~ v0.37 的主要变更内容</a></li>
        <li><a href="https://mozillazg.com/2025/01/whats-new-ptcpdump-v0.27-v0.32.html">ptcpdump v0.27 ~ v0.32 的主要变更内容</a></li>
    </ul>
</section>
<hr/>
<section class="comments" id="comments">
    <h2>Comments</h2>
    <script src="https://giscus.app/client.js"
            data-repo="mozillazg/mozillazg.github.com"
            data-repo-id="MDEwOlJlcG9zaXRvcnk3Njc4MTA2"
            data-category="Announcements"
            data-category-id="DIC_kwDOAHUoms4CckZl"
            data-mapping="pathname"
            data-strict="0"
            data-reactions-enabled="1"
            data-emit-metadata="0"
            data-input-position="bottom"
            data-theme="preferred_color_scheme"
            data-description="<description>"
            data-lang="en"
            data-loading="lazy"
            crossorigin="anonymous"
            async>
    </script>
</section>
        </article>
    </section>

        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2025 mozillazg
            &middot; Powered by <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>
            &middot; <a href="/privacy-policy.html" target="_blank">Privacy</a>              <p><small>  <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="/static/images/by-sa-80x15.png" /></a>
    &quot;<span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">mozillazg's Blog</span>&quot; by <a xmlns:cc="http://creativecommons.org/ns#" href="https://mozillazg.com" property="cc:attributionName" rel="cc:attributionURL">mozillazg</a> is
  licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>, except where indicated otherwise.
</small></p>
         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="/theme/cdn.jsdelivr.net/npm/jquery@2.1.1/dist/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="/theme/cdn.jsdelivr.net/npm/bootstrap@3.3.4/dist/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->


<!-- share.js -->
<script src="/theme/cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script>



<script src="/theme/cdn.jsdelivr.net/npm/tocbot@3.0.2/dist/tocbot.min.js"></script>
<script>
$(document).ready(function(){
  tocbot.init({
    // Where to render the table of contents.
    tocSelector: '.js-toc',
    // Where to grab the headings to build the table of contents.
    contentSelector: '.entry-content',
    // Which headings to grab inside of the contentSelector element.
    headingSelector: 'h2, h3, h4,h5',
    // Headings that match the ignoreSelector will be skipped.
    ignoreSelector: '.js-toc-ignore',
    // Main class to add to links.
    linkClass: 'toc-link',
    // Extra classes to add to links.
    extraLinkClasses: '',
    // Class to add to active links,
    // the link corresponding to the top most heading on the page.
    activeLinkClass: 'is-active-link',
    // Main class to add to lists.
    listClass: 'toc-list',
    // Extra classes to add to lists.
    extraListClasses: '',
    // Class that gets added when a list should be collapsed.
    isCollapsedClass: 'is-collapsed',
    // Class that gets added when a list should be able
    // to be collapsed but isn't necessarily collpased.
    collapsibleClass: 'is-collapsible',
    // Class to add to list items.
    listItemClass: 'toc-list-item',
    // How many heading levels should not be collpased.
    // For example, number 6 will show everything since
    // there are only 6 heading levels and number 0 will collpase them all.
    // The sections that are hidden will open
    // and close as you scroll to headings within them.
    collapseDepth: 6,
    // Smooth scrolling enabled.
    smoothScroll: true,
    // Smooth scroll duration.
    smoothScrollDuration: 420,
    // Callback for scroll end (requires: smoothScroll).
    scrollEndCallback: function (e) {},
    // Headings offset between the headings and the top of the document (this is meant for minor adjustments).
    headingsOffset: 0,
    // Timeout between events firing to make sure it's
    // not too rapid (for performance reasons).
    throttleTimeout: 50,
    // Element to add the positionFixedClass to.
    positionFixedSelector: null,
    // Fixed position class to add to make sidebar fixed after scrolling
    // down past the fixedSidebarOffset.
    positionFixedClass: 'is-position-fixed',
    // fixedSidebarOffset can be any number but by default is set
    // to auto which sets the fixedSidebarOffset to the sidebar
    // element's offsetTop from the top of the document on init.
    fixedSidebarOffset: 'auto',
    // includeHtml can be set to true to include the HTML markup from the
    // heading node instead of just including the textContent.
    includeHtml: false
  });
});
</script>
</body>
</html>